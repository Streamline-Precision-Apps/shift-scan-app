{"version":3,"file":"formsService.js","sources":["src/services/formsService.ts"],"sourceRoot":"/","sourcesContent":["// Service for forms business logic\n\nimport prisma from \"../lib/prisma.js\";\nimport { FormStatus } from \"../../generated/prisma/client.js\";\n\n// --- Types ---\nexport interface CreateFormSubmissionParams {\n  formTemplateId: string;\n  userId: string;\n}\n\nexport interface SaveDraftParams {\n  formData: Record<string, string>;\n  formTemplateId: string;\n  userId: string;\n  formType?: string;\n  submissionId?: number;\n  title?: string;\n}\n\nexport interface SaveDraftToPendingParams {\n  formData: Record<string, string>;\n  isApprovalRequired: boolean;\n  formTemplateId: string;\n  userId: string;\n  formType?: string;\n  submissionId?: number;\n  title?: string;\n}\n\nexport interface SavePendingParams {\n  formData: Record<string, string>;\n  formTemplateId: string;\n  userId: string;\n  formType?: string;\n  submissionId?: number;\n  title?: string;\n}\n\nexport interface CreateFormApprovalParams {\n  formSubmissionId: number;\n  signedBy: string;\n  signature: string;\n  comment: string;\n  approval: string;\n}\n\nexport interface UpdateFormApprovalParams {\n  id: string;\n  formSubmissionId: number;\n  comment: string;\n  isApproved: boolean;\n}\n\n/**\n * Create a form submission\n * @param {Object} params\n * @param {string} params.formTemplateId\n * @param {string} params.userId\n */\nexport const ServiceCreateFormSubmission = async ({\n  formTemplateId,\n  userId,\n}: CreateFormSubmissionParams) => {\n  // Fetch the form template to get the field names\n  const formTemplate = await prisma.formTemplate.findUnique({\n    where: { id: formTemplateId },\n    include: {\n      FormGrouping: {\n        include: {\n          Fields: true,\n        },\n      },\n    },\n  });\n  if (!formTemplate) throw new Error(\"Form template not found\");\n  // Initialize the data object with field.id as keys and field.content as default value\n  const initialData: Record<string, string> = {};\n  for (const group of formTemplate.FormGrouping) {\n    for (const field of group.Fields) {\n      initialData[String(field.id)] = field.content || \"\";\n    }\n  }\n  // Create the form submission with the initialized data\n  const submission = await prisma.formSubmission.create({\n    data: {\n      formTemplateId,\n      userId,\n      title: \"\",\n      data: initialData,\n    },\n  });\n  return submission;\n};\n\n/**\n * Delete a form submission\n * @param {number} id\n */\nexport const ServiceDeleteFormSubmission = async (id: number) => {\n  await prisma.formSubmission.delete({ where: { id } });\n  return true;\n};\n\n/**\n * Save a draft form submission\n * @param {Object} params\n * @param {Record<string, string>} params.formData\n * @param {string} params.formTemplateId\n * @param {string} params.userId\n * @param {string} [params.formType]\n * @param {number} [params.submissionId]\n * @param {string} [params.title]\n */\nexport const ServiceSaveDraft = async (params: SaveDraftParams) => {\n  const { formData, formTemplateId, userId, formType, submissionId, title } =\n    params;\n  if (submissionId) {\n    const existingSubmission = await prisma.formSubmission.findUnique({\n      where: { id: submissionId },\n    });\n    if (!existingSubmission) throw new Error(\"Submission not found\");\n    let existingData: Record<string, string> = {};\n    if (\n      typeof existingSubmission.data === \"object\" &&\n      existingSubmission.data !== null &&\n      !Array.isArray(existingSubmission.data)\n    ) {\n      existingData = existingSubmission.data as Record<string, string>;\n    }\n    const existingTitle = existingSubmission.title;\n    // Only update changed fields\n    const changedFields: Record<string, string> = {};\n    for (const key in formData) {\n      if (formData[key] !== existingData[key]) {\n        changedFields[key] = formData[key] ?? \"\";\n      }\n    }\n    const updatedSubmission = await prisma.formSubmission.update({\n      where: { id: submissionId },\n      data: {\n        title: title || existingTitle,\n        data: { ...existingData, ...changedFields },\n      },\n    });\n    return updatedSubmission;\n  } else {\n    const newSubmission = await prisma.formSubmission.create({\n      data: {\n        title: title || \"\",\n        formTemplateId,\n        userId,\n        formType: formType ?? null,\n        data: formData,\n        status: FormStatus.DRAFT,\n        submittedAt: new Date().toISOString(),\n      },\n    });\n    return newSubmission;\n  }\n};\n\n/**\n * Save a draft and move to pending/approved\n * @param {Object} params\n * @param {Record<string, string>} params.formData\n * @param {boolean} params.isApprovalRequired\n * @param {string} params.formTemplateId\n * @param {string} params.userId\n * @param {string} [params.formType]\n * @param {number} [params.submissionId]\n * @param {string} [params.title]\n */\nexport const ServiceSaveDraftToPending = async (\n  params: SaveDraftToPendingParams\n) => {\n  const {\n    formData,\n    isApprovalRequired,\n    formTemplateId,\n    userId,\n    formType,\n    submissionId,\n    title,\n  } = params;\n  if (submissionId) {\n    const existingSubmission = await prisma.formSubmission.findUnique({\n      where: { id: submissionId },\n    });\n    if (!existingSubmission) throw new Error(\"Submission not found\");\n    let existingData: Record<string, string> = {};\n    if (\n      typeof existingSubmission.data === \"object\" &&\n      existingSubmission.data !== null &&\n      !Array.isArray(existingSubmission.data)\n    ) {\n      existingData = existingSubmission.data as Record<string, string>;\n    }\n    const existingTitle = existingSubmission.title;\n    const changedFields: Record<string, string> = {};\n    for (const key in formData) {\n      if (formData[key] !== existingData[key]) {\n        changedFields[key] = formData[key] ?? \"\";\n      }\n    }\n    const updatedSubmission = await prisma.formSubmission.update({\n      where: { id: submissionId },\n      data: {\n        title: title || existingTitle,\n        data: { ...existingData, ...changedFields },\n        submittedAt: new Date().toISOString(),\n        status: isApprovalRequired ? FormStatus.PENDING : FormStatus.APPROVED,\n      },\n      include: {\n        User: { select: { firstName: true, lastName: true } },\n      },\n    });\n    return updatedSubmission;\n  } else {\n    const newSubmission = await prisma.formSubmission.create({\n      data: {\n        title: title || \"\",\n        formTemplateId,\n        userId,\n        formType: formType ?? null,\n        data: formData,\n        status: isApprovalRequired ? FormStatus.PENDING : FormStatus.APPROVED,\n        submittedAt: new Date().toISOString(),\n      },\n      include: {\n        User: { select: { firstName: true, lastName: true } },\n      },\n    });\n    return newSubmission;\n  }\n};\n\n/**\n * Save a pending form submission\n * @param {Object} params\n * @param {Record<string, string>} params.formData\n * @param {string} params.formTemplateId\n * @param {string} params.userId\n * @param {string} [params.formType]\n * @param {number} [params.submissionId]\n * @param {string} [params.title]\n */\nexport const ServiceSavePending = async (params: SavePendingParams) => {\n  const { formData, formTemplateId, userId, formType, submissionId, title } =\n    params;\n  if (submissionId) {\n    const existingSubmission = await prisma.formSubmission.findUnique({\n      where: { id: submissionId },\n    });\n    if (!existingSubmission) throw new Error(\"Submission not found\");\n    let existingData: Record<string, string> = {};\n    if (\n      typeof existingSubmission.data === \"object\" &&\n      existingSubmission.data !== null &&\n      !Array.isArray(existingSubmission.data)\n    ) {\n      existingData = existingSubmission.data as Record<string, string>;\n    }\n    const existingTitle = existingSubmission.title;\n    const changedFields: Record<string, string> = {};\n    for (const key in formData) {\n      if (formData[key] !== existingData[key]) {\n        changedFields[key] = formData[key] ?? \"\";\n      }\n    }\n    const updatedSubmission = await prisma.formSubmission.update({\n      where: { id: submissionId },\n      data: {\n        title: title || existingTitle,\n        data: { ...existingData, ...changedFields },\n        status: FormStatus.PENDING,\n      },\n    });\n    return updatedSubmission;\n  } else {\n    const newSubmission = await prisma.formSubmission.create({\n      data: {\n        title: title || \"\",\n        formTemplateId,\n        userId,\n        formType: formType ?? null,\n        data: formData,\n        status: FormStatus.PENDING,\n      },\n    });\n    return newSubmission;\n  }\n};\n\n/**\n * Create a form approval\n * @param {Object} params\n * @param {number} params.formSubmissionId\n * @param {string} params.signedBy\n * @param {string} params.signature\n * @param {string} params.comment\n * @param {string} params.approval\n */\nexport const ServiceCreateFormApproval = async (\n  params: CreateFormApprovalParams\n) => {\n  const { formSubmissionId, signedBy, signature, comment, approval } = params;\n  const create = await prisma.formApproval.create({\n    data: {\n      formSubmissionId,\n      signedBy,\n      signature,\n      comment,\n    },\n  });\n  if (create) {\n    await prisma.formSubmission.update({\n      where: { id: formSubmissionId },\n      data: { status: approval as FormStatus },\n    });\n  }\n  return true;\n};\n\n/**\n * Update a form approval\n * @param {Object} params\n * @param {string} params.id\n * @param {number} params.formSubmissionId\n * @param {string} params.comment\n * @param {boolean} params.isApproved\n */\nexport const ServiceUpdateFormApproval = async (\n  params: UpdateFormApprovalParams\n) => {\n  const { id, formSubmissionId, comment, isApproved } = params;\n  // Use a transaction to ensure atomicity\n  const [approval, updatedSubmission] = await prisma.$transaction([\n    prisma.formApproval.update({\n      where: { id },\n      data: { comment },\n    }),\n    prisma.formSubmission.update({\n      where: { id: formSubmissionId },\n      data: { status: isApproved ? FormStatus.APPROVED : FormStatus.DENIED },\n    }),\n  ]);\n  return { approval, updatedSubmission };\n};\n"],"names":[],"mappings":"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","debug_id":"18d6f609-110b-548b-aff9-fc403026cbcb"}